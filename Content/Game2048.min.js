function ignore(){}function id(n){return n}function fst(n){return n[0]}function snd(n){return n[1]}function trd(n){return n[2]}IntelliFactory={Runtime:{Ctor:function(n,t){return n.prototype=t.prototype,n},Class:function(n,t,i){var u=n,f,r,e;if(t){u=new t;for(f in n)u[f]=n[f]}if(r=function(n){if(n)for(var t in n)this[t]=n[t]},r.prototype=u,i)for(e in i)r[e]=i[e];return r},Clone:function(n){var t={};for(var i in n)t[i]=n[i];return t},NewObject:function(n){for(var i={},t=0;t<n.length;t++)i[n[t][0]]=n[t][1];return i},DeleteEmptyFields:function(n,t){for(var r,i=0;i<t.length;i++)r=t[i],n[r]===void 0&&delete n[r];return n},GetOptional:function(n){return n===void 0?null:{$:1,$0:n}},SetOptional:function(n,t,i){i?n[t]=i.$0:delete n[t]},SetOrDelete:function(n,t,i){i===void 0?delete n[t]:n[t]=i},Apply:function(n,t,i){return n.apply(t,i)},Bind:function(n){return function(){return n.apply(this,arguments)}},CreateFuncWithArgs:function(n){return function(){return n(Array.prototype.slice.call(arguments))}},CreateFuncWithOnlyThis:function(n){return function(){return n(this)}},CreateFuncWithThis:function(n){return function(){return n(this).apply(null,arguments)}},CreateFuncWithThisArgs:function(n){return function(){return n(this)(Array.prototype.slice.call(arguments))}},CreateFuncWithRest:function(n,t){return function(){return t(Array.prototype.slice.call(arguments,0,n).concat([Array.prototype.slice.call(arguments,n)]))}},CreateFuncWithArgsRest:function(n,t){return function(){return t([Array.prototype.slice.call(arguments,0,n),Array.prototype.slice.call(arguments,n)])}},BindDelegate:function(n,t){var i=n.bind(t);return i.$Func=n,i.$Target=t,i},CreateDelegate:function(n){if(n.length==0)return null;if(n.length==1)return n[0];var t=function(){for(var i,t=0;t<n.length;t++)i=n[t].apply(null,arguments);return i};return t.$Invokes=n,t},CombineDelegates:function(n){for(var t,i=[],r=0;r<n.length;r++)t=n[r],t&&("$Invokes"in t?i=i.concat(t.$Invokes):i.push(t));return IntelliFactory.Runtime.CreateDelegate(i)},DelegateEqual:function(n,t){var f,e,i,r,u;if(n===t)return!0;if(n==null||t==null||(f=n.$Invokes||[n],e=t.$Invokes||[t],f.length!=e.length))return!1;for(i=0;i<f.length;i++)if(r=f[i],u=e[i],!(r===u||"$Func"in r&&"$Func"in u&&r.$Func===u.$Func&&r.$Target==u.$Target))return!1;return!0},ThisFunc:function(n){return function(){var t=Array.prototype.slice.call(arguments);return t.unshift(this),n.apply(null,t)}},ThisFuncOut:function(n){return function(){var t=Array.prototype.slice.call(arguments);return n.apply(t.shift(),t)}},ParamsFunc:function(n,t){return function(){var i=Array.prototype.slice.call(arguments);return t.apply(null,i.slice(0,n).concat([i.slice(n)]))}},ParamsFuncOut:function(n,t){return function(){var i=Array.prototype.slice.call(arguments);return t.apply(null,i.slice(0,n).concat(i[n]))}},ThisParamsFunc:function(n,t){return function(){var i=Array.prototype.slice.call(arguments);return i.unshift(this),t.apply(null,i.slice(0,n+1).concat([i.slice(n+1)]))}},ThisParamsFuncOut:function(n,t){return function(){var i=Array.prototype.slice.call(arguments);return t.apply(i.shift(),i.slice(0,n).concat(i[n]))}},Curried:function(n,t,i){return i=i||[],function(r){var u=i.concat([r===void 0?null:r]);return t==1?n.apply(null,u):t==2?function(t){return n.apply(null,u.concat([t===void 0?null:t]))}:IntelliFactory.Runtime.Curried(n,t-1,u)}},Curried2:function(n){return function(t){return function(i){return n(t,i)}}},Curried3:function(n){return function(t){return function(i){return function(r){return n(t,i,r)}}}},UnionByType:function(n,t,i){for(var u,f=typeof t,r=0;r<n.length;r++)if(u=n[r],typeof u=="number"){if(Array.isArray(t)&&(u==0||t.length==u))return{$:r,$0:t}}else if(u==f)return{$:r,$0:t};if(!i)throw new Error("Type not expected for creating Choice value.");},ScriptBasePath:"./",ScriptPath:function(n,t){return this.ScriptBasePath+(this.ScriptSkipAssemblyDir?"":n+"/")+t},OnLoad:function(n){"load"in this||(this.load=[]);this.load.push(n)},Start:function(){function n(n){for(var t=0;t<n.length;t++)n[t]()}"load"in this&&(n(this.load),this.load=[])}}};IntelliFactory.Runtime.OnLoad(function(){self.WebSharper&&WebSharper.Activator&&WebSharper.Activator.Activate&&WebSharper.Activator.Activate()});Date.now||(Date.now=function(){return(new Date).getTime()});Math.trunc||(Math.trunc=function(n){return n<0?Math.ceil(n):Math.floor(n)});Object.setPrototypeOf||(Object.setPrototypeOf=function(n,t){return n.__proto__=t,n});console||(console={count:ignore,dir:ignore,error:ignore,group:ignore,groupEnd:ignore,info:ignore,log:ignore,profile:ignore,profileEnd:ignore,time:ignore,timeEnd:ignore,trace:ignore,warn:ignore});
var JSON;JSON||(JSON={}),function(){"use strict";function i(n){return n<10?"0"+n:n}function f(n){return o.lastIndex=0,o.test(n)?'"'+n.replace(o,function(n){var t=s[n];return typeof t=="string"?t:"\\u"+("0000"+n.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+n+'"'}function r(i,e){var s,l,h,a,v=n,c,o=e[i];o&&typeof o=="object"&&typeof o.toJSON=="function"&&(o=o.toJSON(i));typeof t=="function"&&(o=t.call(e,i,o));switch(typeof o){case"string":return f(o);case"number":return isFinite(o)?String(o):"null";case"boolean":case"null":return String(o);case"object":if(!o)return"null";if(n+=u,c=[],Object.prototype.toString.apply(o)==="[object Array]"){for(a=o.length,s=0;s<a;s+=1)c[s]=r(s,o)||"null";return h=c.length===0?"[]":n?"[\n"+n+c.join(",\n"+n)+"\n"+v+"]":"["+c.join(",")+"]",n=v,h}if(t&&typeof t=="object")for(a=t.length,s=0;s<a;s+=1)typeof t[s]=="string"&&(l=t[s],h=r(l,o),h&&c.push(f(l)+(n?": ":":")+h));else for(l in o)Object.prototype.hasOwnProperty.call(o,l)&&(h=r(l,o),h&&c.push(f(l)+(n?": ":":")+h));return h=c.length===0?"{}":n?"{\n"+n+c.join(",\n"+n)+"\n"+v+"}":"{"+c.join(",")+"}",n=v,h}}typeof Date.prototype.toJSON!="function"&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+i(this.getUTCMonth()+1)+"-"+i(this.getUTCDate())+"T"+i(this.getUTCHours())+":"+i(this.getUTCMinutes())+":"+i(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()});var e=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,o=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,n,u,s={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},t;typeof JSON.stringify!="function"&&(JSON.stringify=function(i,f,e){var o;if(n="",u="",typeof e=="number")for(o=0;o<e;o+=1)u+=" ";else typeof e=="string"&&(u=e);if(t=f,f&&typeof f!="function"&&(typeof f!="object"||typeof f.length!="number"))throw new Error("JSON.stringify");return r("",{"":i})});typeof JSON.parse!="function"&&(JSON.parse=function(n,t){function r(n,i){var f,e,u=n[i];if(u&&typeof u=="object")for(f in u)Object.prototype.hasOwnProperty.call(u,f)&&(e=r(u,f),e!==undefined?u[f]=e:delete u[f]);return t.call(n,i,u)}var i;if(n=String(n),e.lastIndex=0,e.test(n)&&(n=n.replace(e,function(n){return"\\u"+("0000"+n.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(n.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return i=eval("("+n+")"),typeof t=="function"?r({"":i},""):i;throw new SyntaxError("JSON.parse");})}();
(function(){"use strict";var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,_0,_1,_2,_3,_4,_5,_6,_7,_8,_9,_,$,ba,bb,bc,bd,be,bf,bg,bh,bi,bj,bk,bl,bm,bn,bo,bp,bq,br,bs,bt,bu,bv,bw,bx,by;a=self;b=a.Game2048=a.Game2048||{};c=b.Client=b.Client||{};d=a.WebSharper=a.WebSharper||{};e=d.Operators=d.Operators||{};f=d.Arrays=d.Arrays||{};g=b.Variants=b.Variants||{};h=d.Obj=d.Obj||{};i=b.Model=b.Model||{};j=i.GameRules=i.GameRules||{};k=b.LocalStorage=b.LocalStorage||{};l=d.Unchecked=d.Unchecked||{};m=d.List=d.List||{};n=d.UI=d.UI||{};o=n.HtmlModule=n.HtmlModule||{};p=o.attr=o.attr||{};q=c.HtmlActuator=c.HtmlActuator||{};r=b.InputManager=b.InputManager||{};s=r.InputManager=r.InputManager||{};t=c.GameState=c.GameState||{};u=c.StoredGame=c.StoredGame||{};v=d.Util=d.Util||{};w=a.StartupCode$Game2048$Variants=a.StartupCode$Game2048$Variants||{};x=k.Ref=k.Ref||{};y=n.Doc=n.Doc||{};z=m.T=m.T||{};A=n.AttrProxy=n.AttrProxy||{};B=a.Object;C=d.Control=d.Control||{};D=C.FSharpEvent=C.FSharpEvent||{};E=d.Collections=d.Collections||{};F=E.Map=E.Map||{};G=d.JavaScript=d.JavaScript||{};H=G.Pervasives=G.Pervasives||{};I=a.EventTarget;J=a.WindowOrWorkerGlobalScope;K=r.Direction=r.Direction||{};L=E.FSharpMap=E.FSharpMap||{};M=d.Strings=d.Strings||{};N=E.List=E.List||{};O=i.TileData=i.TileData||{};P=b.Array2D=b.Array2D||{};Q=d.Seq=d.Seq||{};R=i.Tile=i.Tile||{};S=k.JSONStorageItem=k.JSONStorageItem||{};T=d.Arrays2D=d.Arrays2D||{};U=d.Slice=d.Slice||{};V=b.Array=b.Array||{};W=g.OriginalRules=g.OriginalRules||{};X=g.FibonacciRules=g.FibonacciRules||{};Y=g.PlusMinusRules=g.PlusMinusRules||{};Z=n.DomUtility=n.DomUtility||{};_0=n.Attrs=n.Attrs||{};_1=C.Event=C.Event||{};_2=_1.Event=_1.Event||{};_3=E.MapUtil=E.MapUtil||{};_4=n.Elt=n.Elt||{};_5=d.Enumerator=d.Enumerator||{};_6=_5.T=_5.T||{};_7=n.View=n.View||{};_8=a.Node;_9=n.Array=n.Array||{};_=E.BalancedTree=E.BalancedTree||{};$=E.Pair=E.Pair||{};ba=_.Tree=_.Tree||{};bb=n.DocElemNode=n.DocElemNode||{};bc=a.CharacterData;bd=n.Docs=n.Docs||{};be=n.Updates=n.Updates||{};bf=a.StartupCode$WebSharper_UI$DomUtility=a.StartupCode$WebSharper_UI$DomUtility||{};bg=E.HashSet=E.HashSet||{};bh=n.Snap=n.Snap||{};bi=a.Error;bj=d.IndexOutOfRangeException=d.IndexOutOfRangeException||{};bk=a.StartupCode$Game2048$Utils=a.StartupCode$Game2048$Utils||{};bl=n.Client=n.Client||{};bm=bl.Attrs=bl.Attrs||{};bn=bm.Dyn=bm.Dyn||{};bo=n.Abbrev=n.Abbrev||{};bp=bo.Fresh=bo.Fresh||{};bq=a.StartupCode$WebSharper_UI$Attr_Client=a.StartupCode$WebSharper_UI$Attr_Client||{};br=a.StartupCode$WebSharper_UI$Abbrev=a.StartupCode$WebSharper_UI$Abbrev||{};bs=E.HashSetUtil=E.HashSetUtil||{};bt=d.Queue=d.Queue||{};bu=a.console;bv=a.Math;bw=a.IntelliFactory;bx=bw&&bw.Runtime;by=a.JSON;c.Main=function(){var bz,bA,bB,bC,bD,bE,bF,bG,bH,bO,bP,bQ,bR,bS,bT,bU,bV,bW;function bI(){var bX,bY;bX=bA.Game2048_LocalStorage_IValue_1$get_Value().Game2048_LocalStorage_IValue_1$get_Value();bB.Game2048_LocalStorage_IValue_1$set_Value(bX.Score);bC.Game2048_LocalStorage_IValue_1$set_Value(bX.BestScore);bD.Game2048_LocalStorage_IValue_1$set_Value((bY=bX.Values,bY!=null&&bY.$==1?c.gridFromValues(bY.$0):bT.Game2048_LocalStorage_IValue_1$get_Value().Start()));}function bJ(bX){bA.Game2048_LocalStorage_IValue_1$get_Value().Game2048_LocalStorage_IValue_1$set_Value(u.New(bX?null:{$:1,$0:c.gridValues(bD.Game2048_LocalStorage_IValue_1$get_Value())},bB.Game2048_LocalStorage_IValue_1$get_Value(),bC.Game2048_LocalStorage_IValue_1$get_Value()));}function bK(bX,bY){bJ(bX);bF.Game2048_LocalStorage_IValue_1$set_Value(bX||bY&&!bE.Game2048_LocalStorage_IValue_1$get_Value());return bG.Actuate(bD.Game2048_LocalStorage_IValue_1$get_Value(),t.New(bB.Game2048_LocalStorage_IValue_1$get_Value(),bX,bY,bC.Game2048_LocalStorage_IValue_1$get_Value(),bF.Game2048_LocalStorage_IValue_1$get_Value()));}function bL(){bF.Game2048_LocalStorage_IValue_1$set_Value(false);bG.ClearMessage();}function bM(bX){bT.Game2048_LocalStorage_IValue_1$set_Value(bX);a.jQuery(".title").html(bX.get_Title());a.jQuery(".game-intro").html(bX.get_Hint());bA.Game2048_LocalStorage_IValue_1$set_Value(new S.New(bX.get_Name(),u.New(null,0,0)));bI();bE.Game2048_LocalStorage_IValue_1$set_Value(false);bL();bK(false,false);}function bN(){bB.Game2048_LocalStorage_IValue_1$set_Value(0);bD.Game2048_LocalStorage_IValue_1$set_Value(bT.Game2048_LocalStorage_IValue_1$get_Value().Start());bE.Game2048_LocalStorage_IValue_1$set_Value(false);bL();bK(false,false);}bO=a.jQuery(".select-gametype");for(bP=0,bQ=g.All().length-1;bP<=bQ;bP++){bR=f.get(g.All(),bP);bS="<option value=\""+bR.get_Name()+"\">"+bR.get_Name()+"</option>";bO.append.apply(bO,[bS]);}bT=new x.New(null);bU=a.jQuery(".grid-container");for(bV=1,bW=4;bV<=bW;bV++)(function(){var bX;bX=y.Element("div",m.ofArray([A.Create("class","grid-row")]),f.init(4,function(){return y.Element("div",[A.Create("class","grid-cell")],[]);})).elt,bU.append.apply(bU,[bX]);}());bA=new x.New(null);bB=new x.New(0);bC=new x.New(0);bD=new x.New(null);bE=new x.New(false);bF=new x.New(false);bG=new q.New();bH=new s.New();bO.on("change",function(){var bX,bY,bZ,b0;bX=bO.val();for(bY=0,bZ=g.All().length-1;bY<=bZ;bY++){b0=f.get(g.All(),bY);bX===b0.get_Name()?bM(b0):void 0;bO.blur();}});bH.get_Move().Subscribe(v.observer(function(bX){var bY,bZ;bY=bT.Game2048_LocalStorage_IValue_1$get_Value();bF.Game2048_LocalStorage_IValue_1$get_Value()?void 0:(bZ=c.moveGrid(bB,function(b0,b1){return bY.Merge(b0,b1);},bD.Game2048_LocalStorage_IValue_1$get_Value(),bX),bZ!=null&&bZ.$==1?(bD.Game2048_LocalStorage_IValue_1$set_Value(bZ.$0),bY.Next(bD.Game2048_LocalStorage_IValue_1$get_Value()),bC.Game2048_LocalStorage_IValue_1$get_Value()<bB.Game2048_LocalStorage_IValue_1$get_Value()?bC.Game2048_LocalStorage_IValue_1$set_Value(bB.Game2048_LocalStorage_IValue_1$get_Value()):void 0,bK(!i.moveAvailable(function(b0){return bY.Merge(b0[0],b0[1]);},bD.Game2048_LocalStorage_IValue_1$get_Value()),bY.Goal(bD.Game2048_LocalStorage_IValue_1$get_Value()))):void 0);}));bH.get_Restart().Subscribe(v.observer(function(){bN();}));bH.get_KeepPlaying().Subscribe(v.observer(function(){bE.Game2048_LocalStorage_IValue_1$set_Value(true);bL();}));bM(f.get(g.All(),0));};c.moveGrid=function(bz,bA,bB,bC){var bD,bE,bF,bG,bH,bI,bJ,bK,bL,bM,bN;bD=bB.length;bE=bB.length?bB[0].length:0;bF=f.zeroCreate2D(bD,bE);bu.log("moveGrid");if(bC.$==1){for(bG=0,bH=bD-1;bG<=bH;bG++)(function(bO){var bP;bP=new x.New(bE+1);return U.setArray2Dfix1(bF,bG,null,null,V.pad(bE,i.doMerge(bz,bA,function(){k.decr(bP);return[bO+1,bP.Game2048_LocalStorage_IValue_1$get_Value()];},f.choose(a.id,U.array2Dfix1(bB,bG,null,null)).slice().reverse())).slice().reverse());}(bG));}else if(bC.$==2){for(bI=0,bJ=bE-1;bI<=bJ;bI++)(function(bO){var bP;bP=new x.New(0);return U.setArray2Dfix2(bF,null,null,bI,V.pad(bD,i.doMerge(bz,bA,function(){k.incr(bP);return[bP.Game2048_LocalStorage_IValue_1$get_Value(),bO+1];},f.choose(a.id,U.array2Dfix2(bB,null,null,bI)))));}(bI));}else if(bC.$==3){for(bK=0,bL=bE-1;bK<=bL;bK++)(function(bO){var bP;bP=new x.New(bD+1);return U.setArray2Dfix2(bF,null,null,bK,V.pad(bD,i.doMerge(bz,bA,function(){k.decr(bP);return[bP.Game2048_LocalStorage_IValue_1$get_Value(),bO+1];},f.choose(a.id,U.array2Dfix2(bB,null,null,bK)).slice().reverse())).slice().reverse());}(bK));}else{for(bM=0,bN=bD-1;bM<=bN;bM++)(function(bO){var bP;bP=new x.New(0);return U.setArray2Dfix1(bF,bM,null,null,V.pad(bE,i.doMerge(bz,bA,function(){k.incr(bP);return[bO+1,bP.Game2048_LocalStorage_IValue_1$get_Value()];},f.choose(a.id,U.array2Dfix1(bB,bM,null,null)))));}(bM));}return l.Equals(c.gridValues(bF),c.gridValues(bB))?null:{$:1,$0:bF};};c.gridValues=function(bz){function bA(bB){return bB.Current.Value;}return T.map(function(bB){return bB==null?null:{$:1,$0:bA(bB.$0)};},bz);};c.gridFromValues=function(bz){function bA(bB,bC){function bD(bE){return i.newTile(bB+1,bC+1,bE);}return function(bE){return bE==null?null:{$:1,$0:bD(bE.$0)};};}return T.mapi(function(bB,bC,bD){return(bA(bB,bC))(bD);},bz);};e.FailWith=function(bz){throw new bi(bz);};e.range=function(bz,bA){var bB;bB=1+bA-bz;return bB<=0?[]:Q.init(bB,function(bC){return bC+bz;});};e.toInt=function(bz){var bA;bA=e.toUInt(bz);return bA>=2147483648?bA-4294967296:bA;};e.toUInt=function(bz){return(bz<0?bv.ceil(bz):bv.floor(bz))>>>0;};f.init=function(bz,bA){var bB,bC,bD;bz<0?e.FailWith("Negative size given."):null;bB=new a.Array(bz);for(bC=0,bD=bz-1;bC<=bD;bC++)bB[bC]=bA(bC);return bB;};f.iter=function(bz,bA){var bB,bC;for(bB=0,bC=bA.length-1;bB<=bC;bB++)bz(bA[bB]);};f.choose=function(bz,bA){var bB,bC,bD,bE;bB=[];for(bC=0,bD=bA.length-1;bC<=bD;bC++){bE=bz(bA[bC]);bE==null?void 0:bB.push(bE.$0);}return bB;};f.map=function(bz,bA){var bB,bC,bD;bB=new a.Array(bA.length);for(bC=0,bD=bA.length-1;bC<=bD;bC++)bB[bC]=bz(bA[bC]);return bB;};f.sortInPlace=function(bz){f.mapInPlace(function(bA){return bA[0];},f.mapiInPlace(function(bA,bB){return[bB,bA];},bz).sort(l.Compare));};f.ofSeq=function(bz){var bA,bB;if(bz instanceof a.Array)return bz.slice();else if(bz instanceof z)return f.ofList(bz);else{bA=[];bB=_5.Get(bz);try{while(bB.MoveNext())bA.push(bB.Current());return bA;}finally{if(typeof bB=="object"&&"Dispose"in bB)bB.Dispose();}}};f.ofList=function(bz){var bA,bB;bB=[];bA=bz;while(!(bA.$==0)){bB.push(m.head(bA));bA=m.tail(bA);}return bB;};f.create=function(bz,bA){var bB,bC,bD;bB=new a.Array(bz);for(bC=0,bD=bz-1;bC<=bD;bC++)bB[bC]=bA;return bB;};f.foldBack=function(bz,bA,bB){var bC,bD,bE,bF,bG;bC=bB;bE=bA.length;for(bF=1,bG=bE;bF<=bG;bF++)bC=bz(bA[bE-bF],bC);return bC;};g.All=function(){w.$cctor();return w.All;};f.get=function(bz,bA){f.checkBounds(bz,bA);return bz[bA];};f.checkBounds=function(bz,bA){if(bA<0||bA>=bz.length)e.FailWith("Index was outside the bounds of the array.");};f.length=function(bz){return bz.dims===2?bz.length*bz.length:bz.length;};f.set=function(bz,bA,bB){f.checkBounds(bz,bA);bz[bA]=bB;};f.get2D=function(bz,bA,bB){f.checkBounds2D(bz,bA,bB);return bz[bA][bB];};f.zeroCreate2D=function(bz,bA){var bB;bB=f.init(bz,function(){return f.create(bA,null);});bB.dims=2;return bB;};f.set2D=function(bz,bA,bB,bC){f.checkBounds2D(bz,bA,bB);bz[bA][bB]=bC;};f.checkBounds2D=function(bz,bA,bB){if(bA<0||bB<0||bA>=bz.length||bB>=(bz.length?bz[0].length:0))throw new bj.New();};h=d.Obj=bx.Class({Equals:function(bz){return this===bz;},GetHashCode:function(){return -1;}},null,h);h.New=bx.Ctor(function(){},h);j=i.GameRules=bx.Class({},h,j);j.New=bx.Ctor(function(){h.New.call(this);},j);k.decr=function(bz){bz.Game2048_LocalStorage_IValue_1$set_Value(bz.Game2048_LocalStorage_IValue_1$get_Value()-1);};k.incr=function(bz){bz.Game2048_LocalStorage_IValue_1$set_Value(bz.Game2048_LocalStorage_IValue_1$get_Value()+1);};k.localStorage=function(){bk.$cctor();return bk.localStorage;};l.Equals=function(bz,bA){var bB,bC,bD,bE;if(bz===bA)return true;else{bB=typeof bz;if(bB=="object"){if(bz===null||bz===void 0||bA===null||bA===void 0)return false;else if("Equals"in bz)return bz.Equals(bA);else if(bz instanceof a.Array&&bA instanceof a.Array)return l.arrayEquals(bz,bA);else if(bz instanceof a.Date&&bA instanceof a.Date)return l.dateEquals(bz,bA);else{bC=[true];for(var bF in bz)if(function(bG){bC[0]=!bz.hasOwnProperty(bG)||bA.hasOwnProperty(bG)&&l.Equals(bz[bG],bA[bG]);return!bC[0];}(bF))break;if(bC[0]){for(var bG in bA)if(function(bH){bC[0]=!bA.hasOwnProperty(bH)||bz.hasOwnProperty(bH);return!bC[0];}(bG))break;}return bC[0];}}else return bB=="function"&&("$Func"in bz?bz.$Func===bA.$Func&&bz.$Target===bA.$Target:"$Invokes"in bz&&"$Invokes"in bA&&l.arrayEquals(bz.$Invokes,bA.$Invokes));}};l.Compare=function(bz,bA){var bB,bC,bD,bE,bF,bG;if(bz===bA)return 0;else{bC=typeof bz;switch(bC=="function"?1:bC=="boolean"?2:bC=="number"?2:bC=="string"?2:bC=="object"?3:0){case 0:return typeof bA=="undefined"?0:-1;case 1:return e.FailWith("Cannot compare function values.");case 2:return bz<bA?-1:1;case 3:if(bz===null)bD=-1;else if(bA===null)bD=1;else if("CompareTo"in bz)bD=bz.CompareTo(bA);else if("CompareTo0"in bz)bD=bz.CompareTo0(bA);else if(bz instanceof a.Array&&bA instanceof a.Array)bD=l.compareArrays(bz,bA);else if(bz instanceof a.Date&&bA instanceof a.Date)bD=l.compareDates(bz,bA);else{bE=[0];for(var bH in bz)if(function(bI){return!bz.hasOwnProperty(bI)?false:!bA.hasOwnProperty(bI)?(bE[0]=1,true):(bE[0]=l.Compare(bz[bI],bA[bI]),bE[0]!==0);}(bH))break;if(bE[0]===0){for(var bI in bA)if(function(bJ){return!bA.hasOwnProperty(bJ)?false:!bz.hasOwnProperty(bJ)&&(bE[0]=-1,true);}(bI))break;}bD=bE[0];}return bD;}}};l.arrayEquals=function(bz,bA){var bB,bC;if(f.length(bz)===f.length(bA)){bB=true;bC=0;while(bB&&bC<f.length(bz)){!l.Equals(f.get(bz,bC),f.get(bA,bC))?bB=false:void 0;bC=bC+1;}return bB;}else return false;};l.dateEquals=function(bz,bA){return bz.getTime()===bA.getTime();};l.compareArrays=function(bz,bA){var bB,bC;if(f.length(bz)<f.length(bA))return -1;else if(f.length(bz)>f.length(bA))return 1;else{bB=0;bC=0;while(bB===0&&bC<f.length(bz)){bB=l.Compare(f.get(bz,bC),f.get(bA,bC));bC=bC+1;}return bB;}};l.compareDates=function(bz,bA){return l.Compare(bz.getTime(),bA.getTime());};l.Hash=function(bz){var bA;bA=typeof bz;return bA=="function"?0:bA=="boolean"?bz?1:0:bA=="number"?bz:bA=="string"?l.hashString(bz):bA=="object"?bz==null?0:bz instanceof a.Array?l.hashArray(bz):l.hashObject(bz):0;};l.hashString=function(bz){var bA,bB,bC;if(bz===null)return 0;else{bA=5381;for(bB=0,bC=bz.length-1;bB<=bC;bB++)bA=l.hashMix(bA,bz[bB].charCodeAt());return bA;}};l.hashArray=function(bz){var bA,bB,bC;bA=-34948909;for(bB=0,bC=f.length(bz)-1;bB<=bC;bB++)bA=l.hashMix(bA,l.Hash(f.get(bz,bB)));return bA;};l.hashObject=function(bz){var bA,bB;if("GetHashCode"in bz)return bz.GetHashCode();else{bA=[0];for(var bC in bz)if(function(bD){bA[0]=l.hashMix(l.hashMix(bA[0],l.hashString(bD)),l.Hash(bz[bD]));return false;}(bC))break;return bA[0];}};l.hashMix=function(bz,bA){return(bz<<5)+bz+bA;};m.ofArray=function(bz){var bA,bB,bC;bA=z.Empty;for(bB=f.length(bz)-1,bC=0;bB>=bC;bB--)bA=new z({$:1,$0:f.get(bz,bB),$1:bA});return bA;};m.append=function(bz,bA){var bB,bC,bD,bE,bF;if(bz.$==0)return bA;else if(bA.$==0)return bz;else{bE=new z({$:1});bB=bE;bC=bz;bD=true;while(bD){bB.$0=bC.$0;bC=bC.$1;bC.$==0?bD=false:bB=(bF=new z({$:1}),bB.$1=bF,bF);}bB.$1=bA;return bE;}};m.head=function(bz){return bz.$==1?bz.$0:m.listEmpty();};m.tail=function(bz){return bz.$==1?bz.$1:m.listEmpty();};m.listEmpty=function(){return e.FailWith("The input list was empty.");};p=o.attr=bx.Class({},h,p);q=c.HtmlActuator=bx.Class({Actuate:function(bz,bA){var bB;bB=this;a.requestAnimationFrame(function(){var bC,bD,bE;function bF(bJ,bK){return"tile-position-"+a.String(bJ)+"-"+a.String(bK);}function bG(bJ,bK){return bJ.SetAttribute("class",M.concat(" ",bK));}function bH(bJ,bK,bL){var bM,bN,bO,bP,bQ,bR;bM=y.Element("div",[A.Create("class","tile-inner")],[y.TextNode(a.String(bL.Value))]);bN=f.ofSeq(m.append(m.ofArray(["tile","tile-"+a.String(bL.Value),bF.apply(null,bL.Pos)]),bK));bO=y.Element("div",[],[bM]);bL.Value>2048?bN.push("tile-super"):void 0;bG(bO,bN);bP=bB.tileContainer;bQ=bO.elt;bP.append.apply(bP,[bQ]);return bJ!=null&&bJ.$==1?(bR=bJ.$0,a.requestAnimationFrame(function(){f.set(bN,2,bF.apply(null,bR));bG(bO,bN);})):null;}function bI(bJ,bK){bu.log(bK);bB.messageContainer.addClass(bJ);bB.messageContainer.find("p").first().text(bK);}bB.tileContainer.empty();Q.iter(function(bJ){var bK,bL,bM;bK=bJ.Previous;bK!=null&&bK.$==1?bH({$:1,$0:bJ.Current.Pos},z.Empty,bK.$0):bJ.MergedFrom.length==0?bH(null,m.ofArray(["tile-new"]),bJ.Current):(f.iter((bL={$:1,$0:bJ.Current.Pos},(bM=z.Empty,function(bN){return bH(bL,bM,bN);})),bJ.MergedFrom),bH(null,m.ofArray(["tile-merged"]),bJ.Current));},Q.choose(a.id,P.toSeq(bz)));bB.scoreContainer.empty();bC=bA.Score-bB.score;bB.score=bA.Score;bB.scoreContainer.text(a.String(bB.score));bC>0?(bD=bB.scoreContainer,bE=y.Element("div",[A.Create("class","score-addition")],[y.TextNode("+"+a.String(bC))]).elt,bD.append.apply(bD,[bE])):void 0;bB.bestContainer.text(a.String(bA.BestScore));bA.Terminated?bA.Over?bI("game-over","Game over!"):bA.Won?bI("game-won","You win!"):void 0:void 0;});},ClearMessage:function(){this.messageContainer.removeClass("game-won").removeClass("game-over");}},h,q);q.New=bx.Ctor(function(){h.New.call(this);this.tileContainer=a.jQuery(".tile-container");this.scoreContainer=a.jQuery(".score-container");this.bestContainer=a.jQuery(".best-container");this.messageContainer=a.jQuery(".game-message");this.score=0;},q);s=r.InputManager=bx.Class({get_Move:function(){return this.move.event;},get_Restart:function(){return this.restart.event;},get_KeepPlaying:function(){return this.keepPlaying.event;},bindButtonPress:function(bz,bA){function bB(bC,bD){bz.event.Trigger(null);return bD.preventDefault();}bA.on("click",function(bC){return bB(this,bC);}).on(this.eventTouchend,function(bC){return bB(this,bC);});}},h,s);s.New=bx.Ctor(function(){var bz,bA,bB,bC,bD;bz=this;h.New.call(this);this.move=new D.New();this.restart=new D.New();this.keepPlaying=new D.New();bA=new L.New(m.ofArray([[38,K.Up],[39,K.Right],[40,K.Down],[37,K.Left],[75,K.Up],[76,K.Right],[74,K.Down],[72,K.Left],[87,K.Up],[68,K.Right],[83,K.Down],[65,K.Left]]));a.jQuery(self.document).on("keydown",function(bE){var bF,bG,bH;bF=bE.altKey||bE.ctrlKey||bE.metaKey||bE.shiftKey;bG=bE.which;return!bF?(bH=F.TryFind(bG,bA),bH!=null&&bH.$==1?(bz.move.event.Trigger(bH.$0),bE.preventDefault()):bG===82?(bz.restart.event.Trigger(null),bE.preventDefault()):null):null;});bB=self.navigator.msPointerEnabled;bC=bB?["MSPointerDown","MSPointerMove","MSPointerUp"]:["touchstart","touchmove","touchend"];this.eventTouchend=bC[2];bz.bindButtonPress(this.restart,a.jQuery(".retry-button"));bz.bindButtonPress(this.restart,a.jQuery(".restart-button"));bz.bindButtonPress(this.keepPlaying,a.jQuery(".keep-playing-button"));bD=a.jQuery(".game-container");this.touchStartClient=[0,0];bD.on(bC[0],function(bE){var bF;return bB&&bE.touches.length>1||bE.targetTouches>1?null:(bB?bz.touchStartClient=[bE.pageX,bE.pageY]:(bF=f.get(bE.touches,0),bz.touchStartClient=[bF.clientX,bF.clientY]),bE.preventDefault());});bD.on(this.eventTouchend,function(bE){var bF,bG,bH,bI,bJ,bK;return bB&&bE.touches.length>0||bE.targetTouches>0?null:(bF=bB?[bE.pageX,bE.pageY]:(bG=f.get(bE.changedTouches,0),[bG.clientX,bG.clientY]),(bH=bF[0]-bz.touchStartClient[0],(bI=bv.abs(bH),(bJ=bF[1]-bz.touchStartClient[1],(bK=bv.abs(bJ),(l.Compare(bI,bK)===1?bI:bK)>10?(bz.move.event.Trigger(bI>bK?bH>0?K.Right:K.Left:bJ>0?K.Down:K.Up),bE.preventDefault()):null)))));});},s);t.New=function(bz,bA,bB,bC,bD){return{Score:bz,Over:bA,Won:bB,BestScore:bC,Terminated:bD};};u.New=function(bz,bA,bB){return{Values:bz,Score:bA,BestScore:bB};};v.observer=function(bz){return{OnCompleted:function(){return null;},OnError:function(){return null;},OnNext:bz};};i.moveAvailable=function(bz,bA){var bB,bC,bD;function bE(bF){return bF!=null;}return P.exists(function(bF){return bF==null;},bA)||(bB=T.map(function(bF){return bF!=null&&bF.$==1?bF.$0.Current.Value:0;},bA),(bC=bB.length,(bD=bB.length?bB[0].length:0,Q.exists(function(bF){return bE(bz(bF));},Q.delay(function(){return Q.append(Q.collect(function(bF){return Q.pairwise(U.array2Dfix1(bB,bF,null,null));},e.range(0,bC-1)),Q.delay(function(){return Q.collect(function(bF){return Q.pairwise(U.array2Dfix2(bB,null,null,bF));},e.range(0,bD-1));}));})))));};i.doMerge=function(bz,bA,bB,bC){var bD,bE,bF,bG,bH,bI,bJ,bK,bL,bM,bN,bO;bF=[];bG=new x.New(null);for(bH=0,bI=bC.length-1;bH<=bI;bH++){bJ=f.get(bC,bH);bK=bG.Game2048_LocalStorage_IValue_1$get_Value();bK!=null&&bK.$==1?(bL=bK.$0,bM=bA(bL.Current.Value,bJ.Current.Value),bM!=null&&bM.$==1?(bz.Game2048_LocalStorage_IValue_1$set_Value(bz.Game2048_LocalStorage_IValue_1$get_Value()+bM.$0[1]),bF.push((bN=bB(),i.mergeTiles(bN[0],bN[1],bM.$0[0],bL,bJ))),bG.Game2048_LocalStorage_IValue_1$set_Value(null)):(bF.push((bO=bB(),i.moveTile(bO[0],bO[1],bL))),bG.Game2048_LocalStorage_IValue_1$set_Value({$:1,$0:bJ}))):bG.Game2048_LocalStorage_IValue_1$set_Value({$:1,$0:bJ});}bD=bG.Game2048_LocalStorage_IValue_1$get_Value();bD!=null&&bD.$==1?bF.push((bE=bB(),i.moveTile(bE[0],bE[1],bD.$0))):void 0;return bF;};i.newTile=function(bz,bA,bB){return R.New(O.New([bz,bA],bB),null,[]);};i.mergeTiles=function(bz,bA,bB,bC,bD){return R.New(O.New([bz,bA],bB),null,[bC.Current,bD.Current]);};i.moveTile=function(bz,bA,bB){return R.New(O.New([bz,bA],bB.Current.Value),{$:1,$0:bB.Current},[]);};i.addRandomTile=function(bz,bA){var bB,bC,bD,bE;bB=[];T.iteri(function(bF,bG,bH){return bH==null?void bB.push([bF,bG]):null;},bz);bC=f.get(bB,e.toInt(bv.random()*f.length(bB)));bD=bC[1];bE=bC[0];f.set2D(bz,bE,bD,{$:1,$0:i.newTile(bE+1,bD+1,bA)});};i.gridContains=function(bz,bA){return P.exists(function(bB){return bB!=null&&bB.$==1&&bB.$0.Current.Value===bA;},bz);};w.$cctor=function(){w.$cctor=a.ignore;w.All=[new W.New(),new X.New(),new Y.New()];};x=k.Ref=bx.Class({Game2048_LocalStorage_IValue_1$set_Value:function(bz){this.v=bz;},Game2048_LocalStorage_IValue_1$get_Value:function(){return this.v;}},h,x);x.New=bx.Ctor(function(bz){h.New.call(this);this.v=bz;},x);y=n.Doc=bx.Class({},h,y);y.Element=function(bz,bA,bB){var bC,bD;bC=A.Concat(bA);bD=y.Concat(bB);return _4.New(Z.CreateElement(bz),bC,bD);};y.Concat=function(bz){var bA;bA=_9.ofSeqNonCopying(bz);return _9.TreeReduce(y.get_Empty(),y.Append,bA);};y.TextNode=function(bz){return y.Mk({$:5,$0:Z.CreateText(bz)},_7.Const());};y.Append=function(bz,bA){return y.Mk({$:0,$0:bz.docNode,$1:bA.docNode},_7.Map2Unit(bz.updates,bA.updates));};y.get_Empty=function(){return y.Mk(null,_7.Const());};y.Mk=function(bz,bA){return new y.New(bz,bA);};y.New=bx.Ctor(function(bz,bA){h.New.call(this);this.docNode=bz;this.updates=bA;},y);z=m.T=bx.Class({GetEnumerator:function(){return new _6.New(this,null,function(bz){var bA;bA=bz.s;return bA.$==0?false:(bz.c=bA.$0,bz.s=bA.$1,true);},void 0);}},null,z);z.Empty=new z({$:0});A=n.AttrProxy=bx.Class({},null,A);A.Create=function(bz,bA){return _0.Static(function(bB){Z.SetAttr(bB,bz,bA);});};A.Concat=function(bz){var bA;bA=_9.ofSeqNonCopying(bz);return _9.TreeReduce(_0.EmptyAttr(),A.Append,bA);};A.Append=function(bz,bA){return _0.AppendTree(bz,bA);};D=C.FSharpEvent=bx.Class({},h,D);D.New=bx.Ctor(function(){h.New.call(this);this.event=_2.New([]);},D);F.TryFind=function(bz,bA){return bA.TryFind(bz);};H.NewFromSeq=function(bz){var bA,bB,bC;bA={};bB=_5.Get(bz);try{while(bB.MoveNext()){bC=bB.Current();bA[bC[0]]=bC[1];}}finally{if(typeof bB=="object"&&"Dispose"in bB)bB.Dispose();}return bA;};K.Right={$:3};K.Left={$:2};K.Down={$:1};K.Up={$:0};L=E.FSharpMap=bx.Class({TryFind:function(bz){var bA;bA=_.TryFind($.New(bz,void 0),this.tree);return bA==null?null:{$:1,$0:bA.$0.Value};},Equals:function(bz){return this.get_Count()===bz.get_Count()&&Q.forall2(l.Equals,this,bz);},get_Count:function(){var bz;bz=this.tree;return bz==null?0:bz.Count;},GetEnumerator$1:function(){return _5.Get(Q.map(function(bz){return{K:bz.Key,V:bz.Value};},_.Enumerate(false,this.tree)));},GetHashCode:function(){return l.Hash(f.ofSeq(this));},CompareTo0:function(bz){return Q.compareWith(l.Compare,this,bz);},GetEnumerator:function(){return this.GetEnumerator$1();}},h,L);L.New=bx.Ctor(function(bz){L.New$1.call(this,_3.fromSeq(bz));},L);L.New$1=bx.Ctor(function(bz){h.New.call(this);this.tree=bz;},L);M.concat=function(bz,bA){return f.ofSeq(bA).join(bz);};N=E.List=bx.Class({GetEnumerator:function(){return _5.Get(this);}},null,N);O.New=function(bz,bA){return{Pos:bz,Value:bA};};P.toSeq=function(bz){var bA,bB;bA=bz.length;bB=bz.length?bz[0].length:0;return Q.delay(function(){return Q.collect(function(bC){return Q.map(function(bD){return f.get2D(bz,bC,bD);},e.range(0,bB-1));},e.range(0,bA-1));});};P.exists=function(bz,bA){var bB,bC,bD,bE,bF;bD=bA.length;bE=bA.length?bA[0].length:0;bB=false;bC=0;while(!bB&&bC<bD){bF=0;while(!bB&&bF<bE){bB=bz(f.get2D(bA,bC,bF));bF=bF+1;}bC=bC+1;}return bB;};Q.choose=function(bz,bA){return Q.collect(function(bB){var bC;bC=bz(bB);return bC==null?z.Empty:m.ofArray([bC.$0]);},bA);};Q.iter=function(bz,bA){var bB;bB=_5.Get(bA);try{while(bB.MoveNext())bz(bB.Current());}finally{if(typeof bB=="object"&&"Dispose"in bB)bB.Dispose();}};Q.delay=function(bz){return{GetEnumerator:function(){return _5.Get(bz());}};};Q.append=function(bz,bA){return{GetEnumerator:function(){var bB,bC;bB=_5.Get(bz);bC=[true];return new _6.New(bB,null,function(bD){var bE;return bD.s.MoveNext()?(bD.c=bD.s.Current(),true):(bE=bD.s,!l.Equals(bE,null)?bE.Dispose():void 0,bD.s=null,bC[0]&&(bC[0]=false,bD.s=_5.Get(bA),bD.s.MoveNext()?(bD.c=bD.s.Current(),true):(bD.s.Dispose(),bD.s=null,false)));},function(bD){var bE;bE=bD.s;!l.Equals(bE,null)?bE.Dispose():void 0;});}};};Q.collect=function(bz,bA){return Q.concat(Q.map(bz,bA));};Q.pairwise=function(bz){return Q.map(function(bA){return[f.get(bA,0),f.get(bA,1)];},Q.windowed(2,bz));};Q.exists=function(bz,bA){var bB,bC;bB=_5.Get(bA);try{bC=false;while(!bC&&bB.MoveNext())bC=bz(bB.Current());return bC;}finally{if(typeof bB=="object"&&"Dispose"in bB)bB.Dispose();}};Q.map=function(bz,bA){return{GetEnumerator:function(){var bB;bB=_5.Get(bA);return new _6.New(null,null,function(bC){return bB.MoveNext()&&(bC.c=bz(bB.Current()),true);},function(){bB.Dispose();});}};};Q.concat=function(bz){return{GetEnumerator:function(){var bA;bA=_5.Get(bz);return new _6.New(null,null,function(bB){var bC;while(true){bC=bB.s;if(l.Equals(bC,null)){if(bA.MoveNext()){bB.s=_5.Get(bA.Current());bB=bB;}else{bA.Dispose();return false;}}else if(bC.MoveNext()){bB.c=bC.Current();return true;}else{bB.Dispose();bB.s=null;bB=bB;}}},function(bB){var bC;bC=bB.s;!l.Equals(bC,null)?bC.Dispose():void 0;!l.Equals(bA,null)?bA.Dispose():void 0;});}};};Q.windowed=function(bz,bA){bz<=0?e.FailWith("The input must be positive."):void 0;return Q.delay(function(){return Q.enumUsing(_5.Get(bA),function(bB){var bC;bC=[];return Q.append(Q.enumWhile(function(){return bC.length<bz&&bB.MoveNext();},Q.delay(function(){bC.push(bB.Current());return[];})),Q.delay(function(){return bC.length===bz?Q.append([bC.slice(0)],Q.delay(function(){return Q.enumWhile(function(){return bB.MoveNext();},Q.delay(function(){bC.shift();bC.push(bB.Current());return[bC.slice(0)];}));})):[];}));});});};Q.init=function(bz,bA){return Q.take(bz,Q.initInfinite(bA));};Q.distinctBy=function(bz,bA){return{GetEnumerator:function(){var bB,bC;bB=_5.Get(bA);bC=new bg.New$3();return new _6.New(null,null,function(bD){var bE,bF;if(bB.MoveNext()){bE=bB.Current();bF=bC.Add(bz(bE));while(!bF&&bB.MoveNext()){bE=bB.Current();bF=bC.Add(bz(bE));}return bF&&(bD.c=bE,true);}else return false;},function(){bB.Dispose();});}};};Q.take=function(bz,bA){bz<0?Q.nonNegative():void 0;return{GetEnumerator:function(){var bB;bB=[_5.Get(bA)];return new _6.New(0,null,function(bC){var bD;bC.s=bC.s+1;return bC.s>bz?false:(bD=bB[0],l.Equals(bD,null)?Q.insufficient():bD.MoveNext()?(bC.c=bD.Current(),bC.s===bz?(bD.Dispose(),bB[0]=null):void 0,true):(bD.Dispose(),bB[0]=null,Q.insufficient()));},function(){var bC;bC=bB[0];!l.Equals(bC,null)?bC.Dispose():void 0;});}};};Q.initInfinite=function(bz){return{GetEnumerator:function(){return new _6.New(0,null,function(bA){bA.c=bz(bA.s);bA.s=bA.s+1;return true;},void 0);}};};Q.compareWith=function(bz,bA,bB){var bC,bD,bE,bF,bG;bC=_5.Get(bA);try{bE=_5.Get(bB);try{bF=0;bG=true;while(bG&&bF===0)if(bC.MoveNext())bF=bE.MoveNext()?bz(bC.Current(),bE.Current()):1;else if(bE.MoveNext())bF=-1;else bG=false;bD=bF;}finally{if(typeof bE=="object"&&"Dispose"in bE)bE.Dispose();}return bD;}finally{if(typeof bC=="object"&&"Dispose"in bC)bC.Dispose();}};Q.forall2=function(bz,bA,bB){return!Q.exists2(function(bC,bD){return!bz(bC,bD);},bA,bB);};Q.exists2=function(bz,bA,bB){var bC,bD,bE,bF;bC=_5.Get(bA);try{bE=_5.Get(bB);try{bF=false;while(!bF&&bC.MoveNext()&&bE.MoveNext())bF=bz(bC.Current(),bE.Current());bD=bF;}finally{if(typeof bE=="object"&&"Dispose"in bE)bE.Dispose();}return bD;}finally{if(typeof bC=="object"&&"Dispose"in bC)bC.Dispose();}};Q.tryFindIndex=function(bz,bA){var bB,bC,bD;bB=_5.Get(bA);try{bC=true;bD=0;while(bC&&bB.MoveNext())if(bz(bB.Current()))bC=false;else bD=bD+1;return bC?null:{$:1,$0:bD};}finally{if(typeof bB=="object"&&"Dispose"in bB)bB.Dispose();}};Q.unfold=function(bz,bA){return{GetEnumerator:function(){return new _6.New(bA,null,function(bB){var bC;bC=bz(bB.s);return bC==null?false:(bB.c=bC.$0[0],bB.s=bC.$0[1],true);},void 0);}};};R.New=function(bz,bA,bB){return{Current:bz,Previous:bA,MergedFrom:bB};};S=k.JSONStorageItem=bx.Class({getValue:function(){var bz,bA,bB;bz=this.value;return bz!=null&&bz.$==1?bz.$0:(bA=(bB=k.localStorage().getItem(this.key),bB===null?this.def:by.parse(bB)),(this.value={$:1,$0:bA},bA));},Game2048_LocalStorage_IValue_1$set_Value:function(bz){try{k.localStorage().setItem(this.key,by.stringify(bz));this.value={$:1,$0:bz};}catch(bA){a.alert("Saving data to storage failed.");}},Game2048_LocalStorage_IValue_1$get_Value:function(){return this.getValue();}},h,S);S.New=bx.Ctor(function(bz,bA){h.New.call(this);this.key=bz;this.def=bA;this.value=null;},S);T.map=function(bz,bA){return T.init(bA.length,bA.length?bA[0].length:0,function(bB,bC){return bz(f.get2D(bA,bB,bC));});};T.mapi=function(bz,bA){return T.init(bA.length,bA.length?bA[0].length:0,function(bB,bC){return bz(bB,bC,f.get2D(bA,bB,bC));});};T.init=function(bz,bA,bB){var bC,bD,bE,bF,bG;bC=f.zeroCreate2D(bz,bA);for(bD=0,bE=bz-1;bD<=bE;bD++){for(bF=0,bG=bA-1;bF<=bG;bF++)f.set2D(bC,bD,bF,bB(bD,bF));}return bC;};T.iteri=function(bz,bA){var bB,bC,bD,bE,bF,bG;bB=bA.length;bC=bA.length?bA[0].length:0;for(bD=0,bE=bB-1;bD<=bE;bD++){for(bF=0,bG=bC-1;bF<=bG;bF++)bz(bD,bF,f.get2D(bA,bD,bF));}};U.setArray2Dfix1=function(bz,bA,bB,bC,bD){var bE,bF,bG,bH;bE=bB!=null&&bB.$==1?bB.$0:0;bF=bC!=null&&bC.$==1?bC.$0:(bz.length?bz[0].length:0)-1;for(bG=0,bH=bF-bE+1-1;bG<=bH;bG++)f.set2D(bz,bA,bE+bG,f.get(bD,bG));};U.array2Dfix1=function(bz,bA,bB,bC){var bD,bE,bF,bG,bH,bI;bD=bB!=null&&bB.$==1?bB.$0:0;bE=bC!=null&&bC.$==1?bC.$0:(bz.length?bz[0].length:0)-1;bF=bE-bD+1;bG=new a.Array(bF);for(bH=0,bI=bF-1;bH<=bI;bH++)f.set(bG,bH,f.get2D(bz,bA,bD+bH));return bG;};U.setArray2Dfix2=function(bz,bA,bB,bC,bD){var bE,bF,bG,bH;bE=bA!=null&&bA.$==1?bA.$0:0;bF=bB!=null&&bB.$==1?bB.$0:bz.length-1;for(bG=0,bH=bF-bE+1-1;bG<=bH;bG++)f.set2D(bz,bE+bG,bC,f.get(bD,bG));};U.array2Dfix2=function(bz,bA,bB,bC){var bD,bE,bF,bG,bH,bI;bD=bA!=null&&bA.$==1?bA.$0:0;bE=bB!=null&&bB.$==1?bB.$0:bz.length-1;bF=bE-bD+1;bG=new a.Array(bF);for(bH=0,bI=bF-1;bH<=bI;bH++)f.set(bG,bH,f.get2D(bz,bD+bH,bC));return bG;};V.pad=function(bz,bA){var bB,bC,bD;bB=f.map(function(bE){return{$:1,$0:bE};},bA);for(bC=1,bD=bz-f.length(bA);bC<=bD;bC++)bB.push(null);return bB;};W=g.OriginalRules=bx.Class({get_Name:function(){return"Original";},get_Title:function(){return"2048";},get_Hint:function(){return"Join the numbers and get to the <strong>2048 tile!</strong>";},Merge:function(bz,bA){var bB;return bz===bA?(bB=bz*2,{$:1,$0:[bB,bB]}):null;},Next:function(bz){i.addRandomTile(bz,this.NewTileValue());},Goal:function(bz){return i.gridContains(bz,this.get_GoalValue());},Start:function(){var bz,bA,bB,bC;bz=this;bA=(bB=(bC=f.init(4,function(){return f.create(4,null);}),(bC.dims=2,bC)),(function(bD){bz.Next(bD);}(bB),bB));(function(bD){bz.Next(bD);}(bA));return bA;},NewTileValue:function(){return bv.random()<0.9?2:4;},get_GoalValue:function(){return 2048;}},j,W);W.New=bx.Ctor(function(){j.New.call(this);},W);X=g.FibonacciRules=bx.Class({get_Name:function(){return"Fibonacci";},get_Title:function(){return"2584";},get_Hint:function(){return"Join the numbers and get to the <strong>2584 tile!</strong>";},Merge:function(bz,bA){var bB,bC;return(bB=bz-bA,bB===0?bz===1:0<bB?bB<=bA:-bB<=bz)?(bC=bz+bA,{$:1,$0:[bC,bC]}):null;},NewTileValue:function(){return bv.random()<0.9?1:2;},get_GoalValue:function(){return 2584;}},W,X);X.New=bx.Ctor(function(){W.New.call(this);},X);Y=g.PlusMinusRules=bx.Class({get_Name:function(){return"PlusMinus";},get_Title:function(){return"&plusmn;64";},get_Hint:function(){return"Join the numbers and get <strong> both &plusmn;64 tiles!</strong>";},Merge:function(bz,bA){var bB;return bz===bA?(bB=bz*2,{$:1,$0:[bB,bv.abs(bB)]}):bz===-bA?{$:1,$0:[0,0]}:null;},Goal:function(bz){return i.gridContains(bz,this.get_GoalValue())&&i.gridContains(bz,-this.get_GoalValue());},NewTileValue:function(){return(bv.random()<0.9?2:4)*(bv.random()<0.5?1:-1);},get_GoalValue:function(){return 2584;}},W,Y);Y.New=bx.Ctor(function(){W.New.call(this);},Y);Z.CreateElement=function(bz){return Z.Doc().createElement(bz);};Z.SetAttr=function(bz,bA,bB){bz.setAttribute(bA,bB);};Z.Doc=function(){bf.$cctor();return bf.Doc;};Z.CreateText=function(bz){return Z.Doc().createTextNode(bz);};Z.InsertAt=function(bz,bA,bB){var bC;if(!(bB.parentNode===bz&&bA===(bC=bB.nextSibling,l.Equals(bC,null)?null:bC)))bz.insertBefore(bB,bA);};_0.Static=function(bz){return new A({$:3,$0:bz});};_0.Updates=function(bz){return _9.MapTreeReduce(function(bA){return bA.NChanged();},_7.Const(),_7.Map2Unit,bz.DynNodes);};_0.AppendTree=function(bz,bA){var bB;return bz===null?bA:bA===null?bz:(bB=new A({$:2,$0:bz,$1:bA}),(_0.SetFlags(bB,_0.Flags(bz)|_0.Flags(bA)),bB));};_0.EmptyAttr=function(){bq.$cctor();return bq.EmptyAttr;};_0.Insert=function(bz,bA){var bB,bC,bD;function bE(bF){if(!(bF===null))if(bF!=null&&bF.$==1)bB.push(bF.$0);else if(bF!=null&&bF.$==2){bE(bF.$0);bE(bF.$1);}else if(bF!=null&&bF.$==3)bF.$0(bz);else if(bF!=null&&bF.$==4)bC.push(bF.$0);}bB=[];bC=[];bE(bA);bD=bB.slice(0);return bn.New(bz,_0.Flags(bA),bD,bC.length===0?null:{$:1,$0:function(bF){Q.iter(function(bG){bG(bF);},bC);}});};_0.SetFlags=function(bz,bA){bz.flags=bA;};_0.Flags=function(bz){return bz!==null&&bz.hasOwnProperty("flags")?bz.flags:0;};_2=_1.Event=bx.Class({Trigger:function(bz){var bA,bB,bC;bA=this.Handlers.slice();for(bB=0,bC=bA.length-1;bB<=bC;bB++)(f.get(bA,bB))(null,bz);},Subscribe$1:function(bz){var bA;function bB(bD,bE){return bz.OnNext(bE);}function bC(){bA.RemoveHandler$1(bB);}bA=this;this.AddHandler$1(bB);return{Dispose:function(){return bC();}};},AddHandler$1:function(bz){this.Handlers.push(bz);},RemoveHandler$1:function(bz){var bA,bB;bA=Q.tryFindIndex(function(bC){return l.Equals(bz,bC);},this.Handlers);bA==null?void 0:(bB=this.Handlers,bB.splice.apply(bB,[bA.$0,1]));},Subscribe:function(bz){return this.Subscribe$1(bz);},Dispose:a.ignore},null,_2);_2.New=function(bz){return new _2({Handlers:bz});};_3.fromSeq=function(bz){var bA;bA=f.ofSeq(Q.delay(function(){return Q.collect(function(bB){return[$.New(bB[0],bB[1])];},Q.distinctBy(function(bB){return bB[0];},bz));}));f.sortInPlace(bA);return _.Build(bA,0,bA.length-1);};_4=n.Elt=bx.Class({SetAttribute:function(bz,bA){this.elt.setAttribute(bz,bA);}},y,_4);_4.New=function(bz,bA,bB){var bC,bD;bC=bd.CreateElemNode(bz,bA,bB.docNode);bD=be.Create(bB.updates);return new _4.New$1({$:1,$0:bC},_7.Map2Unit(_0.Updates(bC.Attr),bD.v),bz,bD);};_4.New$1=bx.Ctor(function(bz,bA,bB,bC){y.New.call(this,bz,bA);this.docNode$1=bz;this.updates$1=bA;this.elt=bB;this.rvUpdates=bC;},_4);_5.Get=function(bz){return bz instanceof a.Array?_5.ArrayEnumerator(bz):l.Equals(typeof bz,"string")?_5.StringEnumerator(bz):bz.GetEnumerator();};_5.ArrayEnumerator=function(bz){return new _6.New(0,null,function(bA){var bB;bB=bA.s;return bB<f.length(bz)&&(bA.c=f.get(bz,bB),bA.s=bB+1,true);},void 0);};_5.StringEnumerator=function(bz){return new _6.New(0,null,function(bA){var bB;bB=bA.s;return bB<bz.length&&(bA.c=bz[bB],bA.s=bB+1,true);},void 0);};_6=_5.T=bx.Class({MoveNext:function(){return this.n(this);},Current:function(){return this.c;},Dispose:function(){if(this.d)this.d(this);}},h,_6);_6.New=bx.Ctor(function(bz,bA,bB,bC){h.New.call(this);this.s=bz;this.c=bA;this.n=bB;this.d=bC;},_6);_7=n.View=bx.Class({},null,_7);_9.ofSeqNonCopying=function(bz){var bA,bB;if(bz instanceof a.Array)return bz;else if(bz instanceof z)return f.ofList(bz);else if(bz===null)return[];else{bA=[];bB=_5.Get(bz);try{while(bB.MoveNext())bA.push(bB.Current());return bA;}finally{if(typeof bB=="object"&&"Dispose"in bB)bB.Dispose();}}};_9.TreeReduce=function(bz,bA,bB){var bC;function bD(bE,bF){var bG,bH;return bF<=0?bz:bF===1&&(bE>=0&&bE<bC)?f.get(bB,bE):(bH=bF/2>>0,bA(bD(bE,bH),bD(bE+bH,bF-bH)));}bC=f.length(bB);return bD(0,bC);};_9.MapTreeReduce=function(bz,bA,bB,bC){var bD;function bE(bF,bG){var bH,bI;return bG<=0?bA:bG===1&&(bF>=0&&bF<bD)?bz(f.get(bC,bF)):(bI=bG/2>>0,bB(bE(bF,bI),bE(bF+bI,bG-bI)));}bD=f.length(bC);return bE(0,bD);};_.TryFind=function(bz,bA){var bB;bB=(_.Lookup(bz,bA))[0];return bB==null?null:{$:1,$0:bB.Node};};_.Lookup=function(bz,bA){var bB,bC,bD,bE;bB=[];bC=bA;bD=true;while(bD)if(bC==null)bD=false;else{bE=l.Compare(bz,bC.Node);bE===0?bD=false:bE===1?(bB.unshift([true,bC.Node,bC.Left]),bC=bC.Right):(bB.unshift([false,bC.Node,bC.Right]),bC=bC.Left);}return[bC,bB];};_.Build=function(bz,bA,bB){var bC,bD,bE;return bB-bA+1<=0?null:(bC=(bA+bB)/2>>0,(bD=_.Build(bz,bA,bC-1),(bE=_.Build(bz,bC+1,bB),_.Branch(f.get(bz,bC),bD,bE))));};_.Branch=function(bz,bA,bB){var bC,bD;return ba.New(bz,bA,bB,1+(bC=bA==null?0:bA.Height,(bD=bB==null?0:bB.Height,l.Compare(bC,bD)===1?bC:bD)),1+(bA==null?0:bA.Count)+(bB==null?0:bB.Count));};_.Enumerate=function(bz,bA){function bB(bC,bD){var bE;while(true)if(bC==null)return bD.$==1?{$:1,$0:[bD.$0[0],[bD.$0[1],bD.$1]]}:null;else if(bz){bE=bC;bC=bE.Right;bD=new z({$:1,$0:[bE.Node,bE.Left],$1:bD});}else{bE=bC;bC=bE.Left;bD=new z({$:1,$0:[bE.Node,bE.Right],$1:bD});}}return Q.unfold(function(bC){return bB(bC[0],bC[1]);},[bA,z.Empty]);};$=E.Pair=bx.Class({Equals:function(bz){return l.Equals(this.Key,bz.Key);},GetHashCode:function(){return l.Hash(this.Key);},CompareTo0:function(bz){return l.Compare(this.Key,bz.Key);}},null,$);$.New=function(bz,bA){return new $({Key:bz,Value:bA});};ba.New=function(bz,bA,bB,bC,bD){return{Node:bz,Left:bA,Right:bB,Height:bC,Count:bD};};_7.Const=function(bz){var bA;bA=bh.New({$:0,$0:bz});return function(){return bA;};};_7.Map2Unit=function(bz,bA){return _7.CreateLazy(function(){return bh.Map2Unit(bz(),bA());});};_7.CreateLazy=function(bz){var bA;bA={c:null,o:bz};return function(){var bB,bC;bB=bA.c;return bB===null?(bB=bA.o(),bA.c=bB,(bC=bB.s,bC!=null&&bC.$==0)?bA.o=null:bh.WhenObsoleteRun(bB,function(){bA.c=null;}),bB):bB;};};Q.enumUsing=function(bz,bA){return{GetEnumerator:function(){var bB;try{bB=_5.Get(bA(bz));}catch(bC){bz.Dispose();throw bC;}return new _6.New(null,null,function(bD){return bB.MoveNext()&&(bD.c=bB.Current(),true);},function(){bB.Dispose();bz.Dispose();});}};};Q.enumWhile=function(bz,bA){return{GetEnumerator:function(){return new _6.New(null,null,function(bB){var bC;while(true){bC=bB.s;if(l.Equals(bC,null)){if(bz()){bB.s=_5.Get(bA);bB=bB;}else return false;}else if(bC.MoveNext()){bB.c=bC.Current();return true;}else{bC.Dispose();bB.s=null;bB=bB;}}},function(bB){var bC;bC=bB.s;!l.Equals(bC,null)?bC.Dispose():void 0;});}};};bb=n.DocElemNode=bx.Class({Equals:function(bz){return this.ElKey===bz.ElKey;},GetHashCode:function(){return this.ElKey;}},null,bb);bb.New=function(bz,bA,bB,bC,bD,bE){var bF;return new bb((bF={Attr:bz,Children:bA,El:bC,ElKey:bD},(bx.SetOptional(bF,"Delimiters",bB),bx.SetOptional(bF,"Render",bE),bF)));};bd.CreateElemNode=function(bz,bA,bB){var bC;bd.LinkElement(bz,bB);bC=_0.Insert(bz,bA);return bb.New(bC,bB,null,bz,bp.Int(),bx.GetOptional(bC.OnAfterRender));};bd.LinkElement=function(bz,bA){bd.InsertDoc(bz,bA,null);};bd.InsertDoc=function(bz,bA,bB){var bC;return bA!=null&&bA.$==1?bd.InsertNode(bz,bA.$0.El,bB):bA!=null&&bA.$==2?(bC=bA.$0,(bC.Dirty=false,bd.InsertDoc(bz,bC.Current,bB))):bA==null?bB:bA!=null&&bA.$==4?bd.InsertNode(bz,bA.$0.Text,bB):bA!=null&&bA.$==5?bd.InsertNode(bz,bA.$0,bB):bA!=null&&bA.$==6?f.foldBack(function(bD,bE){return bD==null||bD.constructor===B?bd.InsertDoc(bz,bD,bE):bd.InsertNode(bz,bD,bE);},bA.$0.Els,bB):bd.InsertDoc(bz,bA.$0,bd.InsertDoc(bz,bA.$1,bB));};bd.InsertNode=function(bz,bA,bB){Z.InsertAt(bz,bB,bA);return bA;};be=n.Updates=bx.Class({},null,be);be.Create=function(bz){var bA;bA=null;bA=be.New(bz,null,function(){var bB;bB=bA.s;return bB===null?(bB=bh.Copy(bA.c()),bA.s=bB,bh.WhenObsoleteRun(bB,function(){bA.s=null;}),bB):bB;});return bA;};be.New=function(bz,bA,bB){return new be({c:bz,s:bA,v:bB});};bf.$cctor=function(){bf.$cctor=a.ignore;bf.Doc=self.document;};bg=E.HashSet=bx.Class({Add:function(bz){return this.add(bz);},add:function(bz){var bA,bB;bA=this.hash(bz);bB=this.data[bA];return bB==null?(this.data[bA]=[bz],this.count=this.count+1,true):this.arrContains(bz,bB)?false:(bB.push(bz),this.count=this.count+1,true);},arrContains:function(bz,bA){var bB,bC,bD,bE;bB=true;bC=0;bE=bA.length;while(bB&&bC<bE)if(this.equals.apply(null,[bA[bC],bz]))bB=false;else bC=bC+1;return!bB;},GetEnumerator:function(){return _5.Get(bs.concat(this.data));}},h,bg);bg.New$3=bx.Ctor(function(){bg.New$4.call(this,[],l.Equals,l.Hash);},bg);bg.New$4=bx.Ctor(function(bz,bA,bB){var bC;h.New.call(this);this.equals=bA;this.hash=bB;this.data=[];this.count=0;bC=_5.Get(bz);try{while(bC.MoveNext())this.add(bC.Current());}finally{if(typeof bC=="object"&&"Dispose"in bC)bC.Dispose();}},bg);f.mapiInPlace=function(bz,bA){var bB,bC;for(bB=0,bC=bA.length-1;bB<=bC;bB++)bA[bB]=bz(bB,bA[bB]);return bA;};f.mapInPlace=function(bz,bA){var bB,bC;for(bB=0,bC=bA.length-1;bB<=bC;bB++)bA[bB]=bz(bA[bB]);};Q.nonNegative=function(){return e.FailWith("The input must be non-negative.");};Q.insufficient=function(){return e.FailWith("The input sequence has an insufficient number of elements.");};bh.Copy=function(bz){var bA,bB,bC;bA=bz.s;return bA==null?bz:bA!=null&&bA.$==2?(bB=bh.New({$:2,$0:bA.$0,$1:[]}),(bh.WhenObsolete(bz,bB),bB)):bA!=null&&bA.$==3?(bC=bh.New({$:3,$0:[],$1:[]}),(bh.When(bz,function(bD){bh.MarkDone(bC,bz,bD);},bC),bC)):bz;};bh.WhenObsoleteRun=function(bz,bA){var bB;bB=bz.s;bB==null?bA():bB!=null&&bB.$==2?bB.$1.push(bA):bB!=null&&bB.$==3?bB.$1.push(bA):void 0;};bh.Map2Unit=function(bz,bA){var bB,bC,bD;function bE(){var bF,bG,bH;if(!(bF=bD.s,bF!=null&&bF.$==0||bF!=null&&bF.$==2)){bG=bh.ValueAndForever(bz);bH=bh.ValueAndForever(bA);bG!=null&&bG.$==1?bH!=null&&bH.$==1?bG.$0[1]&&bH.$0[1]?bh.MarkForever(bD,null):bh.MarkReady(bD,null):void 0:void 0;}}bB=bz.s;bC=bA.s;return bB!=null&&bB.$==0?bC!=null&&bC.$==0?bh.New({$:0,$0:null}):bA:bC!=null&&bC.$==0?bz:(bD=bh.New({$:3,$0:[],$1:[]}),(bh.When(bz,bE,bD),bh.When(bA,bE,bD),bD));};bh.WhenObsolete=function(bz,bA){var bB;bB=bz.s;bB==null?bh.Obsolete(bA):bB!=null&&bB.$==2?bh.EnqueueSafe(bB.$1,bA):bB!=null&&bB.$==3?bh.EnqueueSafe(bB.$1,bA):void 0;};bh.When=function(bz,bA,bB){var bC;bC=bz.s;bC==null?bh.Obsolete(bB):bC!=null&&bC.$==2?(bh.EnqueueSafe(bC.$1,bB),bA(bC.$0)):bC!=null&&bC.$==3?(bC.$0.push(bA),bh.EnqueueSafe(bC.$1,bB)):bA(bC.$0);};bh.MarkDone=function(bz,bA,bB){var bC;if(bC=bA.s,bC!=null&&bC.$==0)bh.MarkForever(bz,bB);else bh.MarkReady(bz,bB);};bh.ValueAndForever=function(bz){var bA;bA=bz.s;return bA!=null&&bA.$==0?{$:1,$0:[bA.$0,true]}:bA!=null&&bA.$==2?{$:1,$0:[bA.$0,false]}:null;};bh.MarkForever=function(bz,bA){var bB,bC,bD,bE;bB=bz.s;if(bB!=null&&bB.$==3){bz.s={$:0,$0:bA};bC=bB.$0;for(bD=0,bE=f.length(bC)-1;bD<=bE;bD++)(f.get(bC,bD))(bA);}else void 0;};bh.MarkReady=function(bz,bA){var bB,bC,bD,bE;bB=bz.s;if(bB!=null&&bB.$==3){bz.s={$:2,$0:bA,$1:bB.$1};bC=bB.$0;for(bD=0,bE=f.length(bC)-1;bD<=bE;bD++)(f.get(bC,bD))(bA);}else void 0;};bh.EnqueueSafe=function(bz,bA){var bB,bC,bD,bE;bz.push(bA);if(bz.length%20===0){bB=bz.slice(0);bt.Clear(bz);for(bC=0,bD=f.length(bB)-1;bC<=bD;bC++){bE=f.get(bB,bC);typeof bE=="object"?function(bF){if(bF.s)bz.push(bF);}(bE):function(bF){bz.push(bF);}(bE);}}else void 0;};bj=d.IndexOutOfRangeException=bx.Class({},bi,bj);bj.New=bx.Ctor(function(){bj.New$1.call(this,"Index was outside the bounds of the array.");},bj);bj.New$1=bx.Ctor(function(bz){this.message=bz;B.setPrototypeOf(this,bj.prototype);},bj);bk.$cctor=function(){bk.$cctor=a.ignore;bk.localStorage=self.localStorage;};bn.New=function(bz,bA,bB,bC){var bD;bD={DynElem:bz,DynFlags:bA,DynNodes:bB};bx.SetOptional(bD,"OnAfterRender",bC);return bD;};bp.Int=function(){bp.set_counter(bp.counter()+1);return bp.counter();};bp.set_counter=function(bz){br.$cctor();br.counter=bz;};bp.counter=function(){br.$cctor();return br.counter;};bq.$cctor=function(){bq.$cctor=a.ignore;bq.EmptyAttr=null;};bh.Obsolete=function(bz){var bA,bB,bC,bD,bE;bB=bz.s;if(bB==null||(bB!=null&&bB.$==2?(bA=bB.$1,false):bB!=null&&bB.$==3?(bA=bB.$1,false):true))void 0;else{bz.s=null;for(bC=0,bD=f.length(bA)-1;bC<=bD;bC++){bE=f.get(bA,bC);typeof bE=="object"?function(bF){bh.Obsolete(bF);}(bE):bE();}}};bh.New=function(bz){return{s:bz};};br.$cctor=function(){br.$cctor=a.ignore;br.counter=0;};bs.concat=function(bz){var bA,bB;bA=[];for(var bC in bz)bA.push.apply(bA,bz[bC]);return bA;};bt.Clear=function(bz){bz.splice(0,f.length(bz));};bx.OnLoad(function(){c.Main();});}());


if (typeof IntelliFactory !=='undefined') {
  IntelliFactory.Runtime.ScriptBasePath = '/Content/';
  IntelliFactory.Runtime.Start();
}
